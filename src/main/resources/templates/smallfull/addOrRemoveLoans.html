<!DOCTYPE html>
<html
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.w3.org/1999/xhtml"
        layout:decorate="~{layouts/baseLayout}">>
<head>
    <meta charset="UTF-8">
    <title id="page-title-heading">
        Loans to directors
    </title>
</head>
<body>
<div id="loanToDirectors-main-content" layout:fragment="content">
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">

            <div th:replace="fragments/numberedHeading :: numberedHeading (
                  headingText = 'Loans to directors'
              )">
            </div>

            <h2 id="loansToDirectors-subheading" class="govuk-heading-m">
                Enter the details for each individual loan to the director.
            </h2>

            <span id="loansToDirectors-help-text" class="govuk-hint">
                You can report more loans for the same director or other directors later if you need to. You can report up to 20 loans.
            </span>

            <dl class="app-check-your-answers app-check-your-answers--short"
                th:if="${addOrRemoveLoans.existingLoans != null and addOrRemoveLoans.existingLoans.length > 0}">

                <div class="app-check-your-answers__contents cya-desktop-only">
                    <dt class="app-check-your-answers__answer govuk-heading-s" id="loans-table-name-heading">Name of
                        director
                    </dt>
                    <dd class="app-check-your-answers__answer govuk-heading-s govuk-!-font-weight-bold"
                        id="loans-table-appointed-heading">
                        <span th:text="'Balance at ' + ${#temporals.format(nextAccounts.periodEndOn, 'd MMM yyyy')}"
                              th:id="loans-table-period-end"></span>
                    </dd>
                    <dd class="app-check-your-answers__change"></dd>
                </div>

                <div th:each="loan, stat : ${addOrRemoveLoans.existingLoans}" class="app-check-your-answers__contents">
                     
                    <div class="app-check-your-answers__contents">
	                    <dt class="app-check-your-answers__question" th:text="${loan.directorName}"
	                        th:id="loan-table-name[__${stat.index}__]">
	                        <br/>
	                    </dt>
	
	                    <dd class="app-check-your-answers__answer">
	                        <span th:text="${loan.breakdown.balanceAtPeriodEnd}"
	                              th:id="loan-table-balance-period-end[__${stat.index}__]"></span>
	                    </dd>
	
	                    <dd class="app-check-your-answers__change">
	                        <form class="form"
	                              th:action="@{/company/{companyNumber}/transaction/{transactionId}/company-accounts/{companyAccountsId}/small-full/note/add-or-remove-loans/remove/{loanId}
	                            (companyNumber=${companyNumber},transactionId=${transactionId},companyAccountsId=${companyAccountsId},loanId=${loan.id})}"
	                              method="get">
	                            <div class="flex-container-center-align">
	                                <input id="remove-loan-button" class="button-display-as-link piwik-event"
	                                       data-event-id="Loans to directors - remove loan"
	                                       type="submit" role="button" value="Remove"/>
	                            </div>
	
	
	                    </form>
	                    </dd>
	                    </div>
                    
                    <div class="app-check-your-answers__contents">
                        <details class="govuk-details" role="group">
                            <summary class="govuk-details__summary" role="button" aria-controls="loan-description-help-text"
                                     aria-expanded="false">
	                            <span id="loan-description-help-text-link left-indent" class="govuk-details__summary-text">
	                              Expand
	                            </span>
                            </summary>
                            <div class="govuk-details__text" id="loan-description-help-text" aria-hidden="true">
                            <span id="loan-description-title-text" class="govuk-details__summary-text"
                                  th:text="${loan.description}"></span>
                                <br/>
                                <div class="govuk-grid-row">
                                    <div class="govuk-grid-column-one-half govuk-body" id="currencySubtitle">
                                        <div class="govuk-grid-column-one-half column-flex" style="text-align: right">
                                            <strong id="breakdownCurrency">Â£</strong>
                                        </div>
                                    </div>
                                </div>

                                <div class="govuk-grid-column-one-half govuk-body" id="breakdownPreviousBalanceAtSubtitle"
                                     th:text="'Balance at ' + ${#temporals.format(nextAccounts.periodStartOn, 'd MMM yyyy')}">
                                    <span  th:text="${loan.breakdown.balanceAtPeriodStart}"></span>
                                </div>

                                <div class="govuk-grid-column-one-half govuk-body" id="breakdownAdvancesCreditsMadeSubtitle"
                                     th:text="'Advances of credits made '">
                                 <span id="loan-breakdown-credit-made-text" class="govuk-details__summary-text"
                                       th:text="${loan.breakdown.advancesCreditsMade}"></span>
                                </div>
                                <div class="govuk-grid-column-one-half govuk-body" id="breakdownAdvancesCreditsRepaidSubtitle"
                                     th:text="'Advances of credits repaid'">
                            <span id="loan-breakdown-credit-repaid-text" class="govuk-details__summary-text"
                                  th:text="${loan.breakdown.advancesCreditsRepaid}"></span>
                                </div>

                                <div class="govuk-grid-column-one-half govuk-body" id="breakdownCurrentBalanceAtSubtitle"
                                     th:text="'Balance at ' + ${#temporals.format(nextAccounts.periodEndOn, 'd MMM yyyy')}">

                            <span id="loan-breakdown-at-period-end-text" class="govuk-details__summary-text"
                                  th:text="${loan.breakdown.balanceAtPeriodEnd}"></span>
                                </div>

                            </div>
                        </details>
                    </div>
                </div>
            </dl>

            <form id="data-submission-form" th:action="@{''}" class="form" th:object="${addOrRemoveLoans}" method="post">

                <div th:each="loan, stat : ${addOrRemoveLoans.existingLoans}">
                    <input type="hidden" th:field="${addOrRemoveLoans.existingLoans[__${stat.index}__].directorName}"
                           th:id="existingLoans[__${stat.index}__].directorName"/>
                    <input type="hidden"
                           th:field="${addOrRemoveLoans.existingLoans[__${stat.index}__].breakdown.balanceAtPeriodEnd}"
                           th:id="existingLoans[__${stat.index}__].breakdown.balanceAtPeriodEnd"/>
                    <input type="hidden" th:field="${addOrRemoveLoans.existingLoans[__${stat.index}__].id}"
                           th:id="existingLoans[__${stat.index}__].id"/>
                </div>

                    <div class="govuk-form-group govuk-form-group-block-important">

                        <label id="loan-director-name-label" class="govuk-label govuk-label--m"
                               for="directorToAdd-name">
                            Name of director receiving advance or credit
                        </label>

                        <input class="govuk-input"
                               id="directorToAdd-name"
                               th:field="*{loanToAdd.directorName}"
                               type="text">

                    <div>
                        <label id="loan-director-description-label" class="govuk-label govuk-label--m"
                               for="loanToAdd-description">
                            Description of the loan
                        </label>

                        <textarea class="govuk-textarea"
                                  id="loanToAdd-description"
                                  th:field="*{loanToAdd.description}"
                                  type="text" rows="5">
                        </textarea>
                    </div>

                <label id="loan-breakdown-label" class="govuk-label govuk-label--m"
                       for="loan-breakdown">
                    Breakdown of the loan
                </label>

                    <div class="govuk-grid-row column-flex" id="loan-breakdown">
                        <div class="govuk-grid-column-one-half" th:replace="fragments/numberInput :: numberInput (
                                  id = 'loanToAdd.breakdown.balanceAtPeriodStart',
                                  text = 'Balance at ' + ${#temporals.format(nextAccounts.periodStartOn, 'd MMM yyyy')},
                                  class= 'govuk-input',
                                  )">
                        </div>
                    </div>
                    <div class="govuk-grid-row column-flex">

                        <div class="govuk-grid-column-one-half"  th:replace="fragments/numberInput :: numberInput (
                                  id = 'loanToAdd.breakdown.advancesCreditsMade',
                                  text = 'Advances and credits made',
                                  class= 'govuk-input',
                                  )">
                        </div>
                    </div>
                    <div class="govuk-grid-row column-flex">

                        <div class="govuk-grid-column-one-half" th:replace="fragments/numberInput :: numberInput (
                                  id = 'loanToAdd.breakdown.advancesCreditsRepaid',
                                  text = 'Advances and credits repaid',
                                  class= 'govuk-input',
                                  )">
                        </div>
                    </div>
                    <div class="govuk-grid-row column-flex">

                        <div class="govuk-grid-column-one-half"  th:replace="fragments/numberInput :: numberInput (
                                  id = 'loanToAdd.breakdown.balanceAtPeriodEnd',
                                  text = 'Balance at ' + ${#temporals.format(nextAccounts.periodEndOn, 'd MMM yyyy')},
                                  class= 'govuk-input',
                                  )">
                        </div>
                    </div>
                </div>

                <div class="govuk-form-group">
			        <input id="save-and-continue-button" class="govuk-button piwik-event"
            			   data-event-id="Loans to directors - save and continue"
              				th:name="submit"
               				type="submit" role="button" value="Save and continue"/>
                    <input id="add-loan-button" class="loan-button secondary-button piwik-event"
                           th:name="add"
                           data-event-id="Loans to directors - add loan"
                           role="button" type="submit" value="Add loan"/>
                </div>

        </form>
    </div>
</div>
</div>
</body>
</html>